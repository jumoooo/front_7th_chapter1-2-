# PRD 문서 (Product Requirements Document)

## 📋 기본 정보

- **작성일**: 2025-10-30
- **프로젝트명**: 일정 관리 앱 - 반복 일정 기능 추가
- **버전**: v1.0
- **작성자**: BMAD Analyst

## 🎯 문제 정의

- **현재 상황**: 사용자가 매주 월요일 회의, 매일 아침 운동 등 반복되는 일정을 매번 수동으로 입력해야 하는 불편함이 존재합니다.
- **사용자 페인포인트**: 
  - 동일한 일정을 반복적으로 입력하는 데 많은 시간이 소요됨
  - 장기 계획 일정(예: 매주 금요일 팀 미팅)을 미리 등록하기 어려움
  - 반복 일정의 일괄 수정/삭제가 불가능하여 관리가 번거로움
- **비즈니스 임팩트**: 
  - 사용자 이탈률 증가 (경쟁 앱 대비 기능 부족)
  - 앱 사용 빈도 감소 (번거로움으로 인한 사용 회피)

## 🎯 목표 및 성공 지표

- **주요 목표**: 반복 일정 기능을 구현하여 사용자가 효율적으로 일정을 관리할 수 있도록 개선
- **성공 지표**:
  - ✅ 반복 일정 생성 시 정확한 날짜 계산 (매일/매주/매월/매년, 특수 케이스 포함)
  - ✅ 반복 일정과 단일 일정을 명확히 구분하여 UI에 표시
  - ✅ 단일/전체 수정 및 삭제 기능이 정상 동작
  - ✅ 테스트 커버리지 90% 이상 달성

## 👥 사용자 스토리

### Epic 1: 반복 일정 생성

- **As a** 일정 관리 앱 사용자
- **I want** 반복되는 일정을 한 번에 등록하고 싶다
- **So that** 매번 동일한 일정을 입력하는 번거로움을 줄일 수 있다

#### User Story 1.1: 반복 유형 선택

- **Given** 사용자가 일정 생성 폼을 열었을 때
- **When** 반복 일정 체크박스를 선택하면
- **Then** 반복 유형 선택 드롭다운이 표시되고, 매일/매주/매월/매년 옵션을 선택할 수 있다

#### User Story 1.2: 반복 간격 설정

- **Given** 사용자가 반복 유형을 선택했을 때
- **When** 반복 간격을 입력하면 (예: 2일마다, 3주마다)
- **Then** 해당 간격에 맞춰 반복 일정이 생성된다

#### User Story 1.3: 반복 종료일 설정

- **Given** 사용자가 반복 설정을 완료했을 때
- **When** 반복 종료일을 입력하면 (최대 2025-12-31)
- **Then** 시작일부터 종료일까지의 반복 일정이 생성된다

### Epic 2: 반복 날짜 계산 로직

- **As a** 개발자
- **I want** 다양한 반복 규칙을 정확하게 계산하고 싶다
- **So that** 사용자에게 정확한 반복 일정을 제공할 수 있다

#### User Story 2.1: 매일 반복 계산

- **Given** 시작일이 2025-01-01이고 매일 반복(interval=1), 종료일이 2025-01-05일 때
- **When** 반복 날짜를 계산하면
- **Then** [1일, 2일, 3일, 4일, 5일] 5개의 일정이 생성된다

- **Given** 시작일이 2025-01-01이고 2일마다 반복(interval=2), 종료일이 2025-01-05일 때
- **When** 반복 날짜를 계산하면
- **Then** [1일, 3일, 5일] 3개의 일정이 생성된다

#### User Story 2.2: 매주 반복 계산

- **Given** 시작일이 2025-10-01(수요일)이고 매주 반복(interval=1), 종료일이 2025-10-30일 때
- **When** 반복 날짜를 계산하면
- **Then** [1일(수), 8일(수), 15일(수), 22일(수), 29일(수)] 5개의 일정이 생성된다

- **Given** 시작일이 2025-10-01이고 2주마다 반복(interval=2), 종료일이 2025-10-30일 때
- **When** 반복 날짜를 계산하면
- **Then** [1일, 15일, 29일] 3개의 일정이 생성된다

#### User Story 2.3: 매월 반복 계산 (일반 케이스)

- **Given** 시작일이 2025-01-15이고 매월 반복(interval=1), 종료일이 2025-04-30일 때
- **When** 반복 날짜를 계산하면
- **Then** [1월 15일, 2월 15일, 3월 15일, 4월 15일] 4개의 일정이 생성된다

#### User Story 2.4: 매월 반복 계산 (31일 특수 케이스)

- **Given** 시작일이 2025-01-31이고 매월 반복(interval=1), 종료일이 2025-04-30일 때
- **When** 반복 날짜를 계산하면
- **Then** [1월 31일, 3월 31일] 2개의 일정이 생성된다 (31일이 없는 2월, 4월은 건너뛰기)

#### User Story 2.5: 매년 반복 계산 (윤년 2/29 특수 케이스)

- **Given** 시작일이 2024-02-29(윤년)이고 매년 반복(interval=1), 종료일이 2028-12-31일 때
- **When** 반복 날짜를 계산하면
- **Then** [2024-02-29, 2028-02-29] 2개의 일정만 생성된다 (2025, 2026, 2027년은 윤년이 아니므로 생성 안 됨)

#### User Story 2.6: 종료일 초과 방지

- **Given** 시작일이 2025-01-01이고 3일마다 반복(interval=3), 종료일이 2025-01-05일 때
- **When** 반복 날짜를 계산하면
- **Then** [1일, 4일] 2개의 일정만 생성된다 (7일은 종료일을 초과하므로 생성 안 됨)

### Epic 3: 반복 일정 표시

- **As a** 일정 관리 앱 사용자
- **I want** 캘린더에서 반복 일정을 명확히 구분하여 보고 싶다
- **So that** 어떤 일정이 반복 일정인지 한눈에 파악할 수 있다

#### User Story 3.1: 반복 일정 아이콘 표시

- **Given** 반복 일정이 생성되었을 때
- **When** 캘린더 뷰를 확인하면
- **Then** 반복 일정에는 반복 아이콘(🔁 또는 Repeat 아이콘)이 표시된다

#### User Story 3.2: 반복 일정 여러 개 표시

- **Given** 매주 월요일 반복 일정이 생성되었을 때
- **When** 월 뷰 캘린더를 확인하면
- **Then** 해당 월의 모든 월요일에 반복 일정이 표시된다

### Epic 4: 반복 일정 수정

- **As a** 일정 관리 앱 사용자
- **I want** 반복 일정을 수정할 때 단일 또는 전체를 선택하고 싶다
- **So that** 필요에 따라 특정 일정만 변경하거나 전체를 일괄 변경할 수 있다

#### User Story 4.1: 단일 수정 (해당 일정만 수정)

- **Given** 사용자가 반복 일정 중 하나를 수정하려고 할 때
- **When** "해당 일정만 수정하시겠어요?" 다이얼로그에서 "예"를 선택하면
- **Then** 해당 일정만 수정되고, 반복 일정 아이콘이 사라지며, 단일 일정으로 전환된다

#### User Story 4.2: 전체 수정 (모든 반복 일정 수정)

- **Given** 사용자가 반복 일정 중 하나를 수정하려고 할 때
- **When** "해당 일정만 수정하시겠어요?" 다이얼로그에서 "아니오"를 선택하면
- **Then** 모든 반복 일정이 수정되고, 반복 일정 아이콘이 유지된다

### Epic 5: 반복 일정 삭제

- **As a** 일정 관리 앱 사용자
- **I want** 반복 일정을 삭제할 때 단일 또는 전체를 선택하고 싶다
- **So that** 필요에 따라 특정 일정만 삭제하거나 전체를 일괄 삭제할 수 있다

#### User Story 5.1: 단일 삭제 (해당 일정만 삭제)

- **Given** 사용자가 반복 일정 중 하나를 삭제하려고 할 때
- **When** "해당 일정만 삭제하시겠어요?" 다이얼로그에서 "예"를 선택하면
- **Then** 해당 일정만 삭제되고, 나머지 반복 일정은 유지된다

#### User Story 5.2: 전체 삭제 (모든 반복 일정 삭제)

- **Given** 사용자가 반복 일정 중 하나를 삭제하려고 할 때
- **When** "해당 일정만 삭제하시겠어요?" 다이얼로그에서 "아니오"를 선택하면
- **Then** 모든 반복 일정이 삭제된다

## 📋 수용 기준 (Acceptance Criteria)

### AC 1: 반복 유형 선택 기능

- ✅ 일정 생성/수정 폼에 반복 체크박스가 존재한다
- ✅ 반복 체크박스 선택 시 반복 유형 드롭다운(매일/매주/매월/매년)이 표시된다
- ✅ 반복 간격 입력 필드가 표시되고, 1 이상의 정수만 입력 가능하다
- ✅ 반복 종료일 입력 필드가 표시되고, 최대 2025-12-31까지만 선택 가능하다
- ✅ 반복 간격과 종료일이 없으면 저장이 불가능하다 (유효성 검사)

### AC 2: 반복 날짜 계산 로직

- ✅ **매일 반복**: 시작일부터 종료일까지 지정된 간격으로 날짜가 생성된다
  - 예: 시작 2025-01-01, 간격 1일, 종료 2025-01-05 → [1, 2, 3, 4, 5]
  - 예: 시작 2025-01-01, 간격 2일, 종료 2025-01-05 → [1, 3, 5]
  
- ✅ **매주 반복**: 시작일부터 종료일까지 지정된 주 간격으로 날짜가 생성된다
  - 예: 시작 2025-10-01(수), 간격 1주, 종료 2025-10-30 → [1, 8, 15, 22, 29]
  - 예: 시작 2025-10-01, 간격 2주, 종료 2025-10-30 → [1, 15, 29]

- ✅ **매월 반복**: 시작일부터 종료일까지 지정된 월 간격으로 날짜가 생성된다
  - 일반 케이스: 각 월의 동일한 날짜에 생성
  - **특수 케이스 (31일)**: 
    - 31일이 없는 달(2월, 4월, 6월, 9월, 11월)은 건너뛰기 (생성하지 않음)
    - 예: 1월 31일 → (2월 건너뜀) → 3월 31일 → (4월 건너뜀) → 5월 31일

- ✅ **매년 반복**: 시작일부터 종료일까지 지정된 년 간격으로 날짜가 생성된다
  - **특수 케이스 (윤년 2/29)**: 
    - 윤년이 아닌 해에는 생성하지 않음
    - 예: 2024-02-29 시작 → 2028-02-29만 생성 (2025, 2026, 2027년은 생성 안 됨)

- ✅ **종료일 초과 방지**: 계산된 날짜가 종료일을 초과하면 생성하지 않는다

### AC 3: 반복 일정 표시

- ✅ 반복 일정에는 반복 아이콘(🔁)이 표시된다
- ✅ 캘린더 뷰에서 반복 일정은 반복 주기에 맞게 여러 개 표시된다
- ✅ 단일 일정으로 전환된 일정은 반복 아이콘이 표시되지 않는다
- ✅ 반복 일정과 일반 일정을 시각적으로 구분할 수 있다

### AC 4: 반복 일정 수정

- ✅ 반복 일정 수정 시 "해당 일정만 수정하시겠어요?" 다이얼로그가 표시된다
- ✅ "예" 선택 시:
  - 해당 일정만 수정된다
  - `repeat.type`이 `'none'`으로 변경된다
  - 반복 아이콘이 사라진다
- ✅ "아니오" 선택 시:
  - 모든 반복 일정이 수정된다
  - 반복 설정이 유지된다
  - 반복 아이콘이 유지된다

### AC 5: 반복 일정 삭제

- ✅ 반복 일정 삭제 시 "해당 일정만 삭제하시겠어요?" 다이얼로그가 표시된다
- ✅ "예" 선택 시:
  - 해당 일정만 삭제된다
  - 나머지 반복 일정은 유지된다
- ✅ "아니오" 선택 시:
  - 모든 반복 일정이 삭제된다

### AC 6: 반복 일정 겹침 처리

- ✅ 반복 일정은 일정 겹침을 고려하지 않는다 (feature_request.md 명세)

## 🚫 비기능 요구사항

- **성능**: 
  - 반복 날짜 계산은 1초 이내에 완료되어야 함
  - 최대 1000개의 반복 일정 인스턴스까지 지원
  
- **테스트**: 
  - 반복 날짜 계산 로직의 단위 테스트 커버리지 95% 이상
  - 전체 프로젝트 테스트 커버리지 90% 이상
  
- **접근성**: 
  - 반복 아이콘에 적절한 aria-label 제공
  - 키보드만으로도 모든 기능 사용 가능
  
- **호환성**: 
  - 최신 Chrome, Firefox, Safari, Edge 브라우저 지원
  - 타임존은 고려하지 않음 (로컬 타임 기준)

## 🧪 테스트 케이스 설계

### 1. 반복 날짜 계산 테스트 (Unit Test)

#### 매일 반복
- ✅ 매일 1일 간격, 시작 2025-01-01, 종료 2025-01-05 → [1, 2, 3, 4, 5]
- ✅ 매일 2일 간격, 시작 2025-01-01, 종료 2025-01-05 → [1, 3, 5]
- ✅ 매일 3일 간격, 시작 2025-01-01, 종료 2025-01-05 → [1, 4]

#### 매주 반복
- ✅ 매주 1주 간격, 시작 2025-10-01(수), 종료 2025-10-30 → [1, 8, 15, 22, 29]
- ✅ 매주 2주 간격, 시작 2025-10-01, 종료 2025-10-30 → [1, 15, 29]
- ✅ 매주 1주 간격, 월을 넘어가는 경우 정확히 계산

#### 매월 반복 (일반)
- ✅ 매월 1개월 간격, 시작 2025-01-15, 종료 2025-04-30 → [1/15, 2/15, 3/15, 4/15]
- ✅ 매월 2개월 간격, 시작 2025-01-15, 종료 2025-06-30 → [1/15, 3/15, 5/15]

#### 매월 반복 (31일 특수 케이스)
- ✅ 매월 1개월 간격, 시작 2025-01-31, 종료 2025-04-30 → [1/31, 2/28, 3/31, 4/30]
- ✅ 매월 1개월 간격, 시작 2025-01-31, 종료 2025-02-28 → [1/31, 2/28]
- ✅ 윤년의 경우: 시작 2024-01-31, 종료 2024-02-29 → [1/31, 2/29]

#### 매년 반복 (일반)
- ✅ 매년 1년 간격, 시작 2024-03-15, 종료 2027-12-31 → [2024/3/15, 2025/3/15, 2026/3/15, 2027/3/15]

#### 매년 반복 (윤년 2/29 특수 케이스)
- ✅ 매년 1년 간격, 시작 2024-02-29, 종료 2028-12-31 → [2024/2/29, 2028/2/29]
- ✅ 매년 1년 간격, 시작 2024-02-29, 종료 2025-12-31 → [2024/2/29] (2025년은 윤년 아님)

### 2. 반복 일정 UI 테스트 (Integration Test)

- ✅ 반복 체크박스 클릭 시 반복 설정 UI가 표시된다
- ✅ 반복 일정 생성 후 캘린더에 여러 개 표시된다
- ✅ 반복 일정에 반복 아이콘이 표시된다
- ✅ 단일 수정 시 반복 아이콘이 사라진다
- ✅ 전체 수정 시 반복 아이콘이 유지된다

### 3. 반복 일정 수정/삭제 테스트 (Integration Test)

- ✅ 반복 일정 수정 시 다이얼로그가 표시된다
- ✅ "해당 일정만" 수정 시 해당 일정만 변경된다
- ✅ "전체" 수정 시 모든 반복 일정이 변경된다
- ✅ 반복 일정 삭제 시 다이얼로그가 표시된다
- ✅ "해당 일정만" 삭제 시 해당 일정만 삭제된다
- ✅ "전체" 삭제 시 모든 반복 일정이 삭제된다

## ⚠️ 리스크 및 제약사항

### 기술적 제약
- **타임존 미지원**: 현재 버전에서는 타임존을 고려하지 않고 로컬 시간 기준으로 동작
- **최대 종료일 제한**: 2025-12-31까지만 반복 일정 생성 가능 (feature_request.md 명세)
- **겹침 검사 미적용**: 반복 일정은 기존 일정과의 겹침을 검사하지 않음

### 잠재적 리스크
- **윤년 계산 오류**: 2월 29일 관련 계산에서 윤년 판단 로직이 중요
- **월별 말일 처리**: 31일 반복 시 각 월의 말일을 정확히 계산해야 함
- **대량 데이터**: 반복 간격이 짧고 종료일이 먼 경우 많은 인스턴스 생성 가능
  - 예: 매일 반복, 2025-01-01 ~ 2025-12-31 → 365개 일정 생성

### 대응 방안
- ✅ 반복 날짜 계산 로직에 대한 철저한 단위 테스트 작성
- ✅ 경계값 테스트 (윤년, 월 말일, 종료일 등)
- ✅ 최대 인스턴스 개수 제한 (1000개) 고려
- ✅ 성능 테스트로 대량 데이터 처리 검증

## 🔄 다음 단계

- ✅ Dev 에이전트에게 TDD 기반 구현 요청
- ✅ QA 에이전트에게 통합 테스트 계획 전달
- ✅ Architect의 설계 문서와 함께 구현 가이드 제공

## ✅ 체크리스트

- ✅ 모든 사용자 스토리가 Given-When-Then 형식으로 작성됨
- ✅ 수용 기준이 테스트 가능함
- ✅ 비기능 요구사항이 명확함
- ✅ 리스크가 식별되고 대응 방안이 있음
- ✅ 다음 에이전트가 작업할 수 있는 충분한 정보 제공

---

## 📈 점수 현황 (Score Status)

- **획득 점수 (Acquired Score):** 5점 (체크리스트 5개 항목 완료)
- **누적 점수 (Cumulative Score):** 12점 (이전 Architect 7점 + 현재 5점)
- **총점 (Total Score):** 80점 (Architect 7 + Analyst 5 + Dev 50 + QA 18)

---

**Analyst 작업 완료**: 요구사항이 구체적이고 테스트 가능한 형태로 변환되었습니다. Dev 에이전트가 TDD 기반으로 구현할 수 있도록 충분한 정보를 제공했습니다.

